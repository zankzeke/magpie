
<html>
<head>
	<title>Material Property Predictor</title>
	<link rel="stylesheet" href="../doc/style.css" type="text/css" media="screen" />
	<script>
	</script>
</head>
<body>
<div id="wrapper">
	<div id="header">
		<h1>Material Property Predictor</h1>
	</div>
	<p>This webpage uses machine learning models trained on data from the 
	<a href="oqmd.org">OQMD</a> to predict properties of crystalline compounds.
	To try out these models, simply provide the (space-delimited)  composition of
	several materials of interest into the following box and click the "Submit" button.</p>
	
	<form id="userinput">
		Compositions: <input type="text" name="comps" id="comps" value="NaCl Zr2Al3Ti">
		<button type="button" name="submit" id="button">Submit</button>
	</form>
	
	<h2>Results</h2>
	<div id="results">
		<p>Nothing computed yet.</p>
	</div>
	
	<!-- Script to run prediction software -->
	<script src="thrift.js"></script>
	<script src="gen-js/MagpieServer.js"></script>
	<script src="gen-js/magpie_types.js"></script>
	<script>
		// Initialize Client
		var transport = new Thrift.Transport("http://127.0.0.1:4581");
		transport.open()
		var protocol  = new Thrift.Protocol(transport);
		var client    = new MagpieServerClient(protocol);
		
		// Function for running computation
		function computeCompounds() {
			// Blank out results
			var results = document.getElementById("results");
			results.innerHTML = "<p>Computing...</p>"
			console.log("started")
			
			// Sample call
			var entry = new Entry();
			entry.name = "NaCl"
			entry.measured_properties = new Map()
			console.log("entry made")
			console.log(entry)
			try {
/*				client.searchSingleObjective('delta_e minimize SimpleEntryRanker',
					'PhaseDiagramCompositionEntryGenerator 2 -alloy 2 Al Ni Zr',
					10, function(result) {
						results.innerHTML = result;
					}) */
				client.evaluateProperties([entry], ["delta_e"], 
					function(result) {
						results.innerHTML = result;
					})
			} catch (err) {
				//console.log(err.get_stack())
				console.log(err.stack)
			}
			
			// Make the call
			var comps = document.getElementById("comps").value;
		}
		
		// Set up listener
		document.getElementById("button").addEventListener('click', computeCompounds, false);
	</script>
	
</div>
</body>
</html>

